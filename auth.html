<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Power Star Official</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --gold: #D4AF37; --bg: #0a0a0a; --card: #161616; }
        body { background: var(--bg); color: white; font-family: 'Arial', sans-serif; margin: 0; overflow: hidden; } /* CSS LOCK */
        
        /* Layout Fix */
        .screen { display: none; height: 100vh; width: 100vw; flex-direction: column; padding: 25px; box-sizing: border-box; }
        .active { display: flex; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from {opacity:0} to {opacity:1} }

        /* Auth Design */
        .auth-container { margin: auto; width: 100%; max-width: 380px; background: var(--card); padding: 30px; border-radius: 20px; border: 1px solid var(--gold); }
        .header-name { color: var(--gold); text-align: center; font-size: 26px; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 30px; }
        
        .field { position: relative; margin-bottom: 20px; }
        input { width: 100%; padding: 15px; background: #000; border: 1px solid #333; color: white; border-radius: 10px; box-sizing: border-box; font-size: 16px; outline: none; }
        input:focus { border-color: var(--gold); }
        .eye { position: absolute; right: 15px; top: 16px; color: var(--gold); cursor: pointer; font-size: 18px; }

        button { width: 100%; padding: 15px; background: var(--gold); color: black; border: none; border-radius: 10px; font-weight: bold; font-size: 16px; cursor: pointer; }
        
        /* Terms Sidebar */
        #side-panel { position: fixed; right: -100%; top: 0; width: 85%; height: 100%; background: #111; z-index: 1000; transition: 0.4s; padding: 30px; border-left: 3px solid var(--gold); box-sizing: border-box; }
        #side-panel.open { right: 0; }

        /* Dashboard & Team Design */
        .card { background: #1a1a1a; padding: 20px; border-radius: 15px; margin-bottom: 15px; border-left: 5px solid var(--gold); }
        .scroll-area { overflow-y: auto; flex: 1; margin-top: 10px; }
    </style>
</head>
<body>

<div id="login-scr" class="screen active">
    <div class="auth-container">
        <div class="header-name">Power Star</div>
        <div class="field">
            <input type="number" id="l-num" placeholder="Mobile Number">
        </div>
        <div class="field">
            <input type="password" id="l-pass" placeholder="Password">
            <i class="fa fa-eye eye" onclick="toggle('l-pass')"></i>
        </div>
        <div class="field">
            <input type="password" id="l-dev" placeholder="Device ID" value="PSS-DEVICE-99" readonly>
            <i class="fa fa-eye eye" onclick="toggle('l-dev')"></i>
        </div>
        <button onclick="doLogin()">LOGIN NOW</button>
        <p onclick="togglePanel()" style="text-align:center; color:#888; font-size:13px; margin-top:20px; text-decoration:underline;">Terms & Conditions</p>
    </div>
</div>

<div id="dash-scr" class="screen">
    <div class="header-name" id="user-display">Welcome</div>
    <div class="card">
        <small style="color:#888">Main Balance</small>
        <h2 id="user-bal" style="color:var(--gold); margin:5px 0;">Rs. 0.00</h2>
        <small id="user-id-text" style="color:var(--gold)"></small>
    </div>
    <button onclick="loadTeam()">MY TEAM MEMBERS</button>
    <button onclick="location.reload()" style="background:#333; color:white; margin-top:10px;">LOGOUT</button>
</div>

<div id="team-scr" class="screen">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2 style="color:var(--gold)">My Team</h2>
        <button onclick="nav('dash-scr')" style="width:auto; padding:5px 15px;">Back</button>
    </div>
    <div id="team-content" class="scroll-area"></div>
</div>

<div id="side-panel">
    <h2 style="color:var(--gold)">Security Rules</h2>
    <p>1. Multiple accounts from one device are strictly prohibited.</p>
    <p>2. Your unique PssN ID is your identity.</p>
    <p>3. Do not share your password with anyone.</p>
    <br><br>
    <button onclick="togglePanel()">I UNDERSTAND</button>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwfOH6oW1CkQV5tOeDOdXgmzIWRdHaUaHdhcYoWJ1BZCRR-w0PWm_v7LjXMGxWH62NaWA/exec";

    function toggle(id) {
        const x = document.getElementById(id);
        x.type = x.type === "password" ? "text" : "password";
    }

    function togglePanel() {
        document.getElementById('side-panel').classList.toggle('open');
    }

    function nav(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    async function doLogin() {
        const n = document.getElementById('l-num').value;
        const p = document.getElementById('l-pass').value;
        if(!n || !p) return alert("Please fill all details!");

        const btn = document.querySelector('button');
        btn.innerText = "Verifying...";

        try {
            const response = await fetch(`${SCRIPT_URL}?action=login&number=${n}&pass=${p}`);
            const res = await response.json();
            if(res.status === "SUCCESS") {
                localStorage.setItem('ps_data', JSON.stringify(res.data));
                openDash(res.data);
            } else {
                alert("Login Failed! Check details.");
                btn.innerText = "LOGIN NOW";
            }
        } catch(e) {
            alert("Connection Error!");
            btn.innerText = "LOGIN NOW";
        }
    }

    function openDash(data) {
        document.getElementById('user-display').innerText = data.name;
        document.getElementById('user-bal').innerText = "Rs. " + data.balance;
        document.getElementById('user-id-text').innerText = "ID: " + data.user_id;
        nav('dash-scr');
    }

    async function loadTeam() {
        const user = JSON.parse(localStorage.getItem('ps_data'));
        const list = document.getElementById('team-content');
        list.innerHTML = "<p style='text-align:center'>Fetching Team...</p>";
        nav('team-scr');

        const response = await fetch(`${SCRIPT_URL}?action=getTeam&myId=${user.user_id}`);
        const res = await response.json();
        
        let html = '';
        if(res.team.length === 0) {
            html = "<p style='text-align:center'>No team members found.</p>";
        } else {
            res.team.forEach(m => {
                html += `<div class="card"><b>${m.name}</b><br><small>ID: ${m.id} | Status: ${m.status}</small></div>`;
            });
        }
        list.innerHTML = html;
    }
</script>
</body>
</html>
